<h1>Ingredients in the Recipe <%= @recipe.name %></h1>
<p>Cook: <%= link_to @recipe.user.name, user_path(@recipe.user) %></p>
<div class="ingredients-list">
  <% @recipe.recipe_ingredients.each do |recipe_ingredient| %>
    <h3><%= recipe_ingredient.ingredient.name %></h3>
    <em>Recipe Note:</em>
    <div>
      <%= recipe_ingredient.notes %>
      <div class="generatedNotes"></div>
    </div>
      <% if @recipe.user === current_user %>
      <%= link_to "Add/Edit Note", recipe_ingredient_path(recipe_ingredient) %>
      <a href="#" class="new-note" recipe-ing-id="<%=recipe_ingredient.id %>">Add/Edit Note</a>
      <div id="note-container" style="display:none">
        https://api.jquery.com/category/traversing/
        <div class="new-note-form-<%=recipe_ingredient.id %>">
          <% @recipe_ingredient = recipe_ingredient %>
          <form id="new-note">
            <p>HI</p>
            <button value="submit">Submit</button>
          </form>
        </div>
      </div>
      <% end %>
      <p></p>
  <% end %>
</div>

<h4><a href="#" class="new-ingredient">+ Add New Ingredient to Recipe</a></h4>
<div class="new-ingredient-form">
</div>

<p><%= link_to "Back to Recipe", recipe_path(@recipe) %></p>

<script type="text/javascript">
$(function () {
  $(".new-ingredient").on("click", function() {
    $('.new-ingredient-form').html(` <%= render partial: 'new_ingredient' %> `)
    event.preventDefault();
  });


  $("a.new-note").on("click", function() {
      var idFoo = $(this).attr('recipe-ing-id')
      var $note-container = $(this).parent('div');
      debugger
      // nextElementSibling or childNodes or lastElementChild
      $('#note-container').toggle();
      $('.edit_recipe_ingredient').on("submit", function() {
      $.get("/recipe_ingredients/" + idFoo + ".json", function(data) {

        //why is my data only the recipe and the ingredient and not the recipe_ingredient
        debugger
       $(".generatedNotes").text(data["recipe"]["name"]);
     });

    });
    event.preventDefault();
  });
});
</script>
